<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Gothic 3D ‚Äì Dolina</title>
<style>
body { margin:0; overflow:hidden; background:#05070d; }
#hud {
    position:absolute;
    top:10px;
    left:10px;
    color:#e0d2a3;
    font-family:monospace;
    background:rgba(0,0,0,0.5);
    padding:10px;
}
</style>
</head>
<body>

<div id="hud">
‚ù§Ô∏è HP: <span id="hp">100</span><br>
üó°Ô∏è LPM ‚Äì atak
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158/build/three.min.js"></script>
<script>
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x0b1020);
scene.fog = new THREE.Fog(0x0b1020, 30, 140);

const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 500);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

// üåû ≈öWIAT≈ÅO
scene.add(new THREE.AmbientLight(0x404040));

const sun = new THREE.DirectionalLight(0xffd9a0, 1);
sun.position.set(50,80,20);
sun.castShadow = true;
scene.add(sun);

// üåç TEREN
const groundGeo = new THREE.PlaneGeometry(300,300,60,60);
groundGeo.rotateX(-Math.PI/2);
for (let v of groundGeo.attributes.position.array) {}
for (let i=0;i<groundGeo.attributes.position.count;i++){
    groundGeo.attributes.position.setY(i, Math.random()*3);
}
groundGeo.computeVertexNormals();

const ground = new THREE.Mesh(
    groundGeo,
    new THREE.MeshStandardMaterial({color:0x2f4f2f})
);
ground.receiveShadow = true;
scene.add(ground);

// üå≤ DRZEWA
function tree(x,z){
    const trunk = new THREE.Mesh(
        new THREE.CylinderGeometry(0.4,0.6,4),
        new THREE.MeshStandardMaterial({color:0x3b2a1a})
    );
    const leaves = new THREE.Mesh(
        new THREE.SphereGeometry(2),
        new THREE.MeshStandardMaterial({color:0x1f5f2a})
    );
    trunk.position.set(x,2,z);
    leaves.position.set(x,5,z);
    trunk.castShadow = leaves.castShadow = true;
    scene.add(trunk,leaves);
}
for(let i=0;i<80;i++)
    tree(Math.random()*200-100,Math.random()*200-100);

// üßç GRACZ
const player = new THREE.Mesh(
    new THREE.CapsuleGeometry(0.5,1.2),
    new THREE.MeshStandardMaterial({color:0x666666})
);
player.position.y = 2;
player.castShadow = true;
scene.add(player);

let playerHP = 100;
let yaw = 0;
const keys = {};
addEventListener("keydown",e=>keys[e.code]=true);
addEventListener("keyup",e=>keys[e.code]=false);

// üê∫ WILK ‚Äì LEPSZY MODEL
function createWolf(x,z){
    const wolf = new THREE.Group();

    const body = new THREE.Mesh(
        new THREE.BoxGeometry(2,1,4),
        new THREE.MeshStandardMaterial({color:0x553333})
    );
    const head = new THREE.Mesh(
        new THREE.BoxGeometry(1,1,1),
        body.material
    );
    body.position.y = 1;
    head.position.set(0,1,2.5);

    wolf.add(body,head);
    wolf.position.set(x,0,z);
    wolf.hp = 50;
    wolf.castShadow = true;
    scene.add(wolf);
    return wolf;
}

const wolves = [
    createWolf(-30,-20),
    createWolf(-40,-30),
    createWolf(-20,-35)
];

// ‚öîÔ∏è ATAK
addEventListener("mousedown",()=>{
    wolves.forEach(w=>{
        if(w.position.distanceTo(player.position)<3){
            w.hp -= 25;
        }
    });
});

// üéÆ MYSZ
document.body.onclick = ()=>document.body.requestPointerLock();
addEventListener("mousemove",e=>{
    if(document.pointerLockElement===document.body)
        yaw -= e.movementX*0.002;
});

// üîÅ LOOP
function animate(){
    requestAnimationFrame(animate);

    const speed=0.12;
    const f = new THREE.Vector3(Math.sin(yaw),0,Math.cos(yaw));
    const r = new THREE.Vector3(Math.sin(yaw+Math.PI/2),0,Math.cos(yaw+Math.PI/2));

    if(keys.KeyW) player.position.add(f.clone().multiplyScalar(-speed));
    if(keys.KeyS) player.position.add(f.clone().multiplyScalar(speed));
    if(keys.KeyA) player.position.add(r.clone().multiplyScalar(speed));
    if(keys.KeyD) player.position.add(r.clone().multiplyScalar(-speed));

    wolves.forEach(w=>{
        const d = w.position.distanceTo(player.position);
        if(d<20){
            w.lookAt(player.position);
            w.translateZ(0.06);
        }
        if(d<2){
            playerHP -= 0.4;
            hp.innerText = Math.floor(playerHP);
        }
        if(w.hp<=0){
            scene.remove(w);
        }
    });

    camera.position.set(
        player.position.x + Math.sin(yaw)*7,
        player.position.y + 3,
        player.position.z + Math.cos(yaw)*7
    );
    camera.lookAt(player.position);

    renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>



